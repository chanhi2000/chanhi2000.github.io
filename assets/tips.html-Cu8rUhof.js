import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,d as s,b as t,at as k,t as v,w as e,r as c,o as h,e as a}from"./app-6nZ4Bu4J.js";const b={},g={id:"frontmatter-title-관련",tabindex:"-1"},f={class:"header-anchor",href:"#frontmatter-title-관련"},w={class:"table-of-contents"};function y(r,n){const i=c("router-link"),o=c("Tabs"),u=c("TagLinks");return h(),m("div",null,[s("h1",g,[s("a",f,[s("span",null,v(r.$frontmatter.title)+" 관련",1)])]),s("nav",w,[s("ul",null,[s("li",null,[t(i,{to:"#get-fully-qualified-domain-name"},{default:e(()=>n[0]||(n[0]=[a("Get Fully Qualified Domain Name")])),_:1})]),s("li",null,[t(i,{to:"#get-just-domain-name"},{default:e(()=>n[1]||(n[1]=[a("Get just domain name")])),_:1})]),s("li",null,[t(i,{to:"#get-os-and-pwsh-info"},{default:e(()=>n[2]||(n[2]=[a("Get OS and Pwsh info")])),_:1})]),s("li",null,[t(i,{to:"#hardware-info"},{default:e(()=>n[3]||(n[3]=[a("Hardware info")])),_:1})]),s("li",null,[t(i,{to:"#time-info"},{default:e(()=>n[4]||(n[4]=[a("Time Info")])),_:1})]),s("li",null,[t(i,{to:"#update-info"},{default:e(()=>n[5]||(n[5]=[a("Update Info")])),_:1}),s("ul",null,[s("li",null,[t(i,{to:"#get-patches"},{default:e(()=>n[6]||(n[6]=[a("Get Patches")])),_:1})]),s("li",null,[t(i,{to:"#what-causes-the-update-failec"},{default:e(()=>n[7]||(n[7]=[a("What Causes the Update Failec")])),_:1})])])])])]),n[20]||(n[20]=s("hr",null,null,-1)),n[21]||(n[21]=s("h2",{id:"get-fully-qualified-domain-name",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#get-fully-qualified-domain-name"},[s("span",null,"Get Fully Qualified Domain Name")])],-1)),t(o,{data:[{id:"powershell"},{id:"result"}],active:0},{title0:e(({value:l,isActive:p})=>n[8]||(n[8]=[a("powershell")])),title1:e(({value:l,isActive:p})=>n[9]||(n[9]=[a("result")])),tab0:e(({value:l,isActive:p})=>n[10]||(n[10]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token punctuation"},"("),s("span",{class:"token namespace"},"[System.Net.Dns]"),a("::GetHostByName"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},"("),s("span",{class:"token variable"},"$env"),a(":computerName"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"."),a("Hostname")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),tab1:e(({value:l,isActive:p})=>n[11]||(n[11]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token comment"},"# URP-PC")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),_:1}),n[22]||(n[22]=s("hr",null,null,-1)),n[23]||(n[23]=s("h2",{id:"get-just-domain-name",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#get-just-domain-name"},[s("span",null,"Get just domain name")])],-1)),t(o,{data:[{id:"powershell"},{id:"result"}],active:0},{title0:e(({value:l,isActive:p})=>n[12]||(n[12]=[a("powershell")])),title1:e(({value:l,isActive:p})=>n[13]||(n[13]=[a("result")])),tab0:e(({value:l,isActive:p})=>n[14]||(n[14]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token punctuation"},"("),s("span",{class:"token function"},"Get-WmiObject"),a(),s("span",{class:"token operator"},"-"),s("span",{class:"token keyword"},"Class"),a(" win32_computersystem"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"."),a("domain")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),tab1:e(({value:l,isActive:p})=>n[15]||(n[15]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token comment"},"# WORKGROUP")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),_:1}),n[24]||(n[24]=s("hr",null,null,-1)),n[25]||(n[25]=s("h2",{id:"get-os-and-pwsh-info",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#get-os-and-pwsh-info"},[s("span",null,"Get OS and Pwsh info")])],-1)),t(o,{data:[{id:"powershell"},{id:"result"}],active:0},{title0:e(({value:l,isActive:p})=>n[16]||(n[16]=[a("powershell")])),title1:e(({value:l,isActive:p})=>n[17]||(n[17]=[a("result")])),tab0:e(({value:l,isActive:p})=>n[18]||(n[18]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token variable"},"$Bit"),a(" = "),s("span",{class:"token punctuation"},"("),s("span",{class:"token function"},"get-wmiobject"),a(" Win32_OperatingSystem"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"."),a("OSArchitecture "),s("span",{class:"token punctuation"},";"),a()]),a(`
`),s("span",{class:"line"},[s("span",{class:"token variable"},"$V"),a(" = "),s("span",{class:"token variable"},"$host"),a(),s("span",{class:"token punctuation"},"|"),a(),s("span",{class:"token function"},"select-object"),a(),s("span",{class:"token operator"},"-"),a("property "),s("span",{class:"token string"},'"Version"'),a(),s("span",{class:"token punctuation"},";"),a()]),a(`
`),s("span",{class:"line"},[s("span",{class:"token variable"},"$Build"),a(" = "),s("span",{class:"token punctuation"},"("),s("span",{class:"token function"},"Get-WmiObject"),a(),s("span",{class:"token operator"},"-"),s("span",{class:"token keyword"},"class"),a(" Win32_OperatingSystem"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"."),a("Caption "),s("span",{class:"token punctuation"},";"),a()]),a(`
`),s("span",{class:"line"},[s("span",{class:"token function"},"write-host"),a(),s("span",{class:"token string"},[a('"'),s("span",{class:"token variable"},"$env"),a(":computername is a "),s("span",{class:"token variable"},"$Bit"),a(),s("span",{class:"token variable"},"$Build"),a(" with Pwsh "),s("span",{class:"token variable"},"$V"),a('"')])]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])),tab1:e(({value:l,isActive:p})=>n[19]||(n[19]=[s("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[s("pre",null,[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{class:"token comment"},"# URP-PC is a 64비트 Microsoft Windows 10 Pro with Pwsh @{Version=5.1.19041.2673}")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"})])],-1)])),_:1}),n[26]||(n[26]=k(`<hr><h2 id="hardware-info" tabindex="-1"><a class="header-anchor" href="#hardware-info"><span>Hardware info</span></a></h2><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token comment">#Get BIOS Info</span></span>
<span class="line">gcim <span class="token operator">-</span>ClassName Win32_BIOS <span class="token punctuation">|</span> <span class="token function">fl</span> Manufacturer<span class="token punctuation">,</span> Name<span class="token punctuation">,</span> SerialNumber<span class="token punctuation">,</span> Version<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">#Get processor info</span></span>
<span class="line">gcim <span class="token operator">-</span>ClassName Win32_Processor <span class="token punctuation">|</span> <span class="token function">fl</span> caption<span class="token punctuation">,</span> Name<span class="token punctuation">,</span> SocketDesignation<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">#Computer Model</span></span>
<span class="line">gcim <span class="token operator">-</span>ClassName Win32_ComputerSystem <span class="token punctuation">|</span> <span class="token function">fl</span> Manufacturer<span class="token punctuation">,</span> Systemfamily<span class="token punctuation">,</span> Model<span class="token punctuation">,</span> SystemType</span>
<span class="line"><span class="token comment">#Disk space in Gigs, as who wants bytes?</span></span>
<span class="line">gcim  <span class="token operator">-</span>ClassName Win32_LogicalDisk <span class="token punctuation">|</span></span>
<span class="line"><span class="token function">Select</span> <span class="token operator">-</span>Property DeviceID<span class="token punctuation">,</span> DriveType<span class="token punctuation">,</span> @<span class="token punctuation">{</span>L=<span class="token string">&#39;FreeSpaceGB&#39;</span><span class="token punctuation">;</span>E=<span class="token punctuation">{</span><span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>FreeSpace <span class="token operator">/</span>1GB<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> @<span class="token punctuation">{</span>L=<span class="token string">&quot;Capacity&quot;</span><span class="token punctuation">;</span>E=<span class="token punctuation">{</span><span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>Size/1GB<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">fl</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">## Let&#39;s calculate an individual directory, C:\\Sysmon, and compare with disk memory stats</span></span>
<span class="line"><span class="token variable">$size</span> = <span class="token punctuation">(</span><span class="token function">gci</span> c:\\sysmon <span class="token punctuation">|</span> <span class="token function">measure</span> Length <span class="token operator">-</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>sum <span class="token operator">/</span> 1Gb<span class="token punctuation">;</span></span>
<span class="line"><span class="token function">write-host</span> <span class="token string">&quot; Sysmon Directory in Gigs: <span class="token variable">$size</span>&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$free</span> = gcim  <span class="token operator">-</span>ClassName Win32_LogicalDisk <span class="token punctuation">|</span> <span class="token function">select</span> @<span class="token punctuation">{</span>L=<span class="token string">&#39;FreeSpaceGB&#39;</span><span class="token punctuation">;</span>E=<span class="token punctuation">{</span><span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>FreeSpace <span class="token operator">/</span>1GB<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">echo</span> <span class="token string">&quot;<span class="token variable">$free</span>&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$cap</span> = gcim  <span class="token operator">-</span>ClassName Win32_LogicalDisk <span class="token punctuation">|</span> <span class="token function">select</span> @<span class="token punctuation">{</span>L=<span class="token string">&quot;Capacity&quot;</span><span class="token punctuation">;</span>E=<span class="token punctuation">{</span><span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>Size/1GB<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span> </span>
<span class="line"><span class="token function">echo</span> <span class="token string">&quot;<span class="token variable">$cap</span>&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="time-info" tabindex="-1"><a class="header-anchor" href="#time-info"><span>Time Info</span></a></h2><details class="hint-container details"><summary>Human Readable</summary><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token function">Get-Date</span> <span class="token operator">-</span>UFormat <span class="token string">&quot;%a %Y-%b-%d %T UTC:%Z&quot;</span> </span>
<span class="line"><span class="token comment"># 수 2023-5-31 19:14:30 UTC:+09</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>Machine comparable</summary><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token namespace">[Xml.XmlConvert]</span>::ToString<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Date</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ToUniversalTime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[System.Xml.XmlDateTimeSerializationMode]</span>::Utc<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 2023-05-31T10:14:50.7607949Z</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>Compare UTC time from Local time</summary><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token variable">$Local</span> = <span class="token function">get-date</span><span class="token punctuation">;</span><span class="token variable">$UTC</span> = <span class="token punctuation">(</span><span class="token function">get-date</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ToUniversalTime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">write-host</span> <span class="token string">&quot;LocalTime is: <span class="token variable">$Local</span>&quot;</span><span class="token punctuation">;</span><span class="token function">write-host</span> <span class="token string">&quot;UTC is: <span class="token variable">$UTC</span>&quot;</span></span>
<span class="line"><span class="token comment"># LocalTime is: 05/31/2023 19:15:14</span></span>
<span class="line"><span class="token comment"># UTC is: 05/31/2023 10:15:14</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><hr><h2 id="update-info" tabindex="-1"><a class="header-anchor" href="#update-info"><span>Update Info</span></a></h2><h3 id="get-patches" tabindex="-1"><a class="header-anchor" href="#get-patches"><span>Get Patches</span></a></h3><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token function">get-hotfix</span><span class="token punctuation">|</span></span>
<span class="line"><span class="token function">select-object</span> HotFixID<span class="token punctuation">,</span>InstalledOn<span class="token punctuation">|</span></span>
<span class="line"><span class="token function">Sort-Object</span>  <span class="token operator">-</span>Descending <span class="token operator">-</span>property InstalledOn<span class="token punctuation">|</span></span>
<span class="line"><span class="token function">format-table</span> <span class="token operator">-</span>autosize</span>
<span class="line"><span class="token comment"># HotFixID  InstalledOn</span></span>
<span class="line"><span class="token comment"># --------  -----------</span></span>
<span class="line"><span class="token comment"># KB5015684 2023-05-22 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5026361 2023-05-10 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5025315 2023-05-10 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5023794 2023-04-12 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5022924 2023-03-16 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5022502 2023-02-17 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5020372 2022-12-13 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5018506 2022-11-10 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5016705 2022-09-15 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5015895 2022-08-11 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5012170 2022-08-11 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5014671 2022-07-18 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5014035 2022-06-15 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5014032 2022-05-19 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB4562830 2022-05-03 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5007401 2022-05-03 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5011651 2022-05-03 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5005699 2021-10-06 오전 12:00:00</span></span>
<span class="line"><span class="token comment"># KB5003791 2021-10-06 오전 12:00:00</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="what-causes-the-update-failec" tabindex="-1"><a class="header-anchor" href="#what-causes-the-update-failec"><span>What Causes the Update Failec</span></a></h3><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token variable">$Failures</span> = <span class="token function">gwmi</span> <span class="token operator">-</span><span class="token keyword">Class</span> Win32_ReliabilityRecords<span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$Failures</span> <span class="token punctuation">|</span> ? message <span class="token operator">-match</span> <span class="token string">&#39;failure&#39;</span>  <span class="token punctuation">|</span> <span class="token function">Select</span> <span class="token operator">-</span>ExpandProperty message </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr>`,15)),t(u)])}const x=d(b,[["render",y]]),S=JSON.parse('{"path":"/programming/pwsh/tips.html","title":"Tips","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Tips","description":"Powershell > Tips","icon":"fas fa-lightbulb","category":["Powershell","Tips"],"tag":["powershell","pwsh","ps1","windows-terminal"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Tips\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/programming/pwsh/tips.html"}],["meta",{"property":"og:site_name","content":"chanhi2000"}],["meta",{"property":"og:title","content":"Tips"}],["meta",{"property":"og:description","content":"Powershell > Tips"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"windows-terminal"}],["meta",{"property":"article:tag","content":"ps1"}],["meta",{"property":"article:tag","content":"pwsh"}],["meta",{"property":"article:tag","content":"powershell"}]]},"git":{},"readingTime":{"minutes":1.65,"words":495},"filePathRelative":"programming/pwsh/tips.md"}');export{x as comp,S as data};
