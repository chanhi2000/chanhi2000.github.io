import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,d as s,at as u,b as a,t as d,w as t,r as o,o as h,e as i}from"./app-6nZ4Bu4J.js";const m="/images/gitlab/troubleshooting/job-failing-w-the-rorror-npm-command-not-found.png",b="/images/gitlab/troubleshooting/gitlab-variables.png",g={},k={id:"frontmatter-title-관련",tabindex:"-1"},v={class:"header-anchor",href:"#frontmatter-title-관련"},y={class:"table-of-contents"};function f(l,n){const e=o("router-link"),p=o("TagLinks");return h(),r("div",null,[s("h1",k,[s("a",v,[s("span",null,d(l.$frontmatter.title)+" 관련",1)])]),s("nav",y,[s("ul",null,[s("li",null,[a(e,{to:"#the-pipeline-is-not-starting"},{default:t(()=>n[0]||(n[0]=[i("The pipeline is not starting")])),_:1})]),s("li",null,[a(e,{to:"#found-errors-in-your-gitlab-ci-yml-stages-config-should-be-an-array-of-strings"},{default:t(()=>n[1]||(n[1]=[i("Found errors in your .gitlab-ci.yml: stages config should be an array of strings")])),_:1})]),s("li",null,[a(e,{to:"#mapping-values-are-not-allowed-in-this-context-at-line-x-column-y"},{default:t(()=>n[2]||(n[2]=[i("Mapping values are not allowed in this context at line X column Y")])),_:1})]),s("li",null,[a(e,{to:"#config-contains-unknown-keys-path"},{default:t(()=>n[3]||(n[3]=[i("Config contains unknown keys: path")])),_:1})]),s("li",null,[a(e,{to:"#some-job-name-config-contains-unknown-keys-paths"},{default:t(()=>n[4]||(n[4]=[i("<some job name> config contains unknown keys: paths")])),_:1})]),s("li",null,[a(e,{to:"#root-config-contains-unknown-keys-some-job-name"},{default:t(()=>n[5]||(n[5]=[i("root config contains unknown keys: <some job name>")])),_:1})]),s("li",null,[a(e,{to:"#unknown-did-not-find-expected-key-while-parsing-a-block-mapping-at-line-1-column-1"},{default:t(()=>n[6]||(n[6]=[i("(<unknown>): did not find expected key while parsing a block mapping at line 1 column 1")])),_:1})]),s("li",null,[a(e,{to:"#this-job-is-stuck-because-you-don-t-have-any-active-runners-that-can-run-this-job-go-to-runners-page"},{default:t(()=>n[7]||(n[7]=[i("This job is stuck because you don't have any active runners that can run this job. Go to Runners page.")])),_:1})]),s("li",null,[a(e,{to:"#unknown-mapping-values-are-not-allowed-in-this-context-at-line-1-column-12"},{default:t(()=>n[8]||(n[8]=[i("(<unknown>): mapping values are not allowed in this context at line 1 column 12")])),_:1})]),s("li",null,[a(e,{to:"#bin-bash-line-line-some-tool-command-not-found"},{default:t(()=>n[9]||(n[9]=[i("/bin/bash: line <line>: <some tool>: command not found")])),_:1})]),s("li",null,[a(e,{to:"#error-job-failed-exit-code-1"},{default:t(()=>n[10]||(n[10]=[i("ERROR: Job failed: exit code 1")])),_:1})])])]),n[11]||(n[11]=u(`<hr><h2 id="the-pipeline-is-not-starting" tabindex="-1"><a class="header-anchor" href="#the-pipeline-is-not-starting"><span>The pipeline is not starting</span></a></h2><p>You have created the YML file with your pipeline but nothing happens. Now what?</p><p>First, check if you have named the pipeline exactly <code>.gitlab-ci.yml</code> and is located at the root of your project. This is not the same as <code>gitlab-ci.yml</code> , <code>.gitlab-ci.yaml</code> or anything else.</p><p>Most people enable Auto DevOps — this is rarely the solution you are looking for. Auto DevOps is meant to create the pipeline for you. Since you already have a pipeline, enabling Auto DevOps is NOT the solution.</p><p>Other common reasons for this problem include:</p><ul><li>the <code>.gitlab-ci.yml</code> has been added to a subdirectory;</li><li>no commits have been pushed to the remote server;</li><li>there are no runners to execute the job;</li></ul><hr><h2 id="found-errors-in-your-gitlab-ci-yml-stages-config-should-be-an-array-of-strings" tabindex="-1"><a class="header-anchor" href="#found-errors-in-your-gitlab-ci-yml-stages-config-should-be-an-array-of-strings"><span>Found errors in your <code>.gitlab-ci.yml</code>: stages config should be an array of strings</span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">stages</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span>build</span>
<span class="line">  <span class="token punctuation">-</span>test</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is a common mistake when you have no added a space after the hyphen sign <code>—</code>.</p><hr><h2 id="mapping-values-are-not-allowed-in-this-context-at-line-x-column-y" tabindex="-1"><a class="header-anchor" href="#mapping-values-are-not-allowed-in-this-context-at-line-x-column-y"><span><code>Mapping values are not allowed in this context at line X column Y</code></span></a></h2><p>This error is hard to spot. Take a look at the pipeline below:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line">stages</span>
<span class="line">  <span class="token punctuation">-</span> build</span>
<span class="line">  <span class="token punctuation">-</span> test</span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">build</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Building&quot;</span>
<span class="line">  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">paths</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> build/       </span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">tests</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> test</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Testing&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The error “<code>(&lt;unknown&gt;): mapping values are not allowed in this context at line 5 column 6</code>” is having us look at line 5, when the problem is actually inside the first line. <code>stages</code> defines a list, and must be followed by a colon, like <code>stages: .</code></p><hr><h2 id="config-contains-unknown-keys-path" tabindex="-1"><a class="header-anchor" href="#config-contains-unknown-keys-path"><span><code>Config contains unknown keys: path</code></span></a></h2><p>Does your pipeline look like this:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">build</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Building&quot;</span>
<span class="line">  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">path</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> build/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The way you specify the build folder as an artifact is by setting the <code>paths</code> property. This is a plural as it can specify a list of files or folders which will be published as artifacts.</p><hr><h2 id="some-job-name-config-contains-unknown-keys-paths" tabindex="-1"><a class="header-anchor" href="#some-job-name-config-contains-unknown-keys-paths"><span><code>&lt;some job name&gt; config contains unknown keys: paths</code></span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">build the car</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> mkdir build</span>
<span class="line">    <span class="token punctuation">-</span> cd build</span>
<span class="line">    <span class="token punctuation">-</span> touch car.txt</span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;chassis&quot; <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> car.txt</span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Engine&quot; <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> car.txt</span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;wheels&quot; <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> car.txt</span>
<span class="line">  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">paths</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> build/  </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is a typical case of improper indentation. <code>paths</code> is a property of <code>artifacts</code> . <strong>Add two spaces</strong> before <code>paths</code> and the problem is solved.</p><hr><h2 id="root-config-contains-unknown-keys-some-job-name" tabindex="-1"><a class="header-anchor" href="#root-config-contains-unknown-keys-some-job-name"><span><code>root config contains unknown keys: &lt;some job name&gt;</code></span></a></h2><p>This is one of the most confusing errors out there. Typically, the error is pointing you in the right direction, but not this time. Have a look at the following configuration:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token punctuation">...</span></span>
<span class="line"><span class="token key atrule">deploy review</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> deploy review</span>
<span class="line">  <span class="token key atrule">only</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> merge requests</span>
<span class="line">  <span class="token key atrule">variables</span><span class="token punctuation">:</span>  </span>
<span class="line">    <span class="token key atrule">GIT_STRATEGY</span><span class="token punctuation">:</span> none</span>
<span class="line">    <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Deploying on review&quot;</span>
<span class="line">    <span class="token punctuation">-</span> sh ./deploy.sh</span>
<span class="line"><span class="token punctuation">...</span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Can you spot the issue? GitLab is not recognizing the configuration <code>deploy reviewas</code> a job. The problem here is that this job configuration is missing the <em>script</em> block. Because the script is not properly indented, it has been defined as a variable.</p><hr><h2 id="unknown-did-not-find-expected-key-while-parsing-a-block-mapping-at-line-1-column-1" tabindex="-1"><a class="header-anchor" href="#unknown-did-not-find-expected-key-while-parsing-a-block-mapping-at-line-1-column-1"><span><code>(&lt;unknown&gt;): did not find expected key while parsing a block mapping at line 1 column 1</code></span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">stages</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> build</span>
<span class="line">  <span class="token punctuation">-</span> test</span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">build the car</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> echo &quot;Build&quot;</span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">test the car</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> test</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> echo &quot;Test&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>What seems to be the issue here? I can assure you there is no issue on line 1 column 1. The problem is bad indentation. The <code>echo</code> command in the first job is not properly indented. The second job is also not properly indented. This is how the configuration should look like:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">stages</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> build</span>
<span class="line">  <span class="token punctuation">-</span> test</span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">build the car</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Build&quot;</span>
<span class="line"> </span>
<span class="line"><span class="token key atrule">test the car</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> test</span>
<span class="line">  <span class="token key atrule">script</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> echo &quot;Test&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="this-job-is-stuck-because-you-don-t-have-any-active-runners-that-can-run-this-job-go-to-runners-page" tabindex="-1"><a class="header-anchor" href="#this-job-is-stuck-because-you-don-t-have-any-active-runners-that-can-run-this-job-go-to-runners-page"><span>This job is stuck because you don&#39;t have any active runners that can run this job. Go to Runners page.</span></a></h2><p>If you use the shared runners from GitLab.com, this will get fixed automatically after a while. Depending on the load, the job might wait a bit.</p><hr><h2 id="unknown-mapping-values-are-not-allowed-in-this-context-at-line-1-column-12" tabindex="-1"><a class="header-anchor" href="#unknown-mapping-values-are-not-allowed-in-this-context-at-line-1-column-12"><span><code>(&lt;unknown&gt;): mapping values are not allowed in this context at line 1 column 12</code></span></a></h2><p>This is a common error if you somehow add a space when specifying the version of the Docker image you want to use. Example</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token key atrule">node</span><span class="token punctuation">:</span> <span class="token number">12</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>It should be:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">image</span><span class="token punctuation">:</span> node<span class="token punctuation">:</span><span class="token number">12</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="bin-bash-line-line-some-tool-command-not-found" tabindex="-1"><a class="header-anchor" href="#bin-bash-line-line-some-tool-command-not-found"><span><code>/bin/bash: line &lt;line&gt;: &lt;some tool&gt;: command not found</code></span></a></h2><p>The first step in resolving this issue is understanding which Docker image is being used by the job.</p><figure><img src="`+m+`" alt="Job failing with the error: npm: command not found." tabindex="0"><figcaption>Job failing with the error: npm: command not found.</figcaption></figure><p>If you don&#39;t specify a Docker image for your job, the GitLab runner executing your job will use the default image, in this case: <code>ruby:2.5</code> . The problem with this is that this Docker container does not have <code>node</code> and <code>npm</code> installed, and this is why the job is failing.</p><p>The easiest solution is to use a Docker image that already has the tools you need, like <code>node</code>.</p><p>If you still wish to use the image (whatever that image is), you need to use the package manager to install any missing tools you need.</p><hr><h2 id="error-job-failed-exit-code-1" tabindex="-1"><a class="header-anchor" href="#error-job-failed-exit-code-1"><span><code>ERROR: Job failed: exit code 1</code></span></a></h2><p>This is a very generic error. You need to look at the console logs from the beginning to the end to understand which commands have been executed and what has happened.</p><blockquote><p>Understanding your logs is key to understanding your pipeline.</p></blockquote><p>If something does not work, try breaking down the job into smaller parts to identify the root cause for your error.</p><p>Once you have identified that error, search for that specific error.</p><blockquote><p>If you want to <strong>learn how to build pipelines in Gitlab CI</strong>, I have created an online course that starts with the basics of Gitlab CI and YAML and helps you understand the fundamentals of CI/CD. <a href="https://www.udemy.com/course/gitlab-ci-pipelines-ci-cd-and-devops-for-beginners/?couponCode=MEDIUM21" target="_blank" rel="noopener noreferrer">Learn more about the course</a>.</p></blockquote><p>Environment variables are not resolved Quite often we set environment variables in GitLab to avoid storing them inside our Git repositories. To see if they are working, add the following line of code in your scripts:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token punctuation">-</span> echo $SOME_VARIABLE</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Try to see if this works both within the main branch, was well as in the merge requests. If it only works on the main branch, re-check your configuration.</p><figure><img src="`+b+'" alt="Gitlab Variables" tabindex="0"><figcaption>Gitlab Variables</figcaption></figure><p>Make sure you understand the difference between a protected variable and a masked variable. If you have a variable which you need in Merge Requests / branches, this variable needs to be unprotected, as most likely the branch itself is unprotected.</p><hr>',64)),a(p)])}const j=c(g,[["render",f]]),T=JSON.parse('{"path":"/devops/gitlab/troubleshooting.html","title":"Troubleshooting","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Troubleshooting","description":"Gitlab > Troubleshooting","icon":"fas fa-bug-slash","category":["Gitlab","Troubleshooting"],"tag":["troubleshooting","git","gitlab","gitlab-ci","gitlab-cli","sh","yml","gitlab"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Troubleshooting\\",\\"image\\":[\\"https://chanhi2000.github.io/images/gitlab/troubleshooting/job-failing-w-the-rorror-npm-command-not-found.png\\",\\"https://chanhi2000.github.io/images/gitlab/troubleshooting/gitlab-variables.png\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/devops/gitlab/troubleshooting.html"}],["meta",{"property":"og:site_name","content":"chanhi2000"}],["meta",{"property":"og:title","content":"Troubleshooting"}],["meta",{"property":"og:description","content":"Gitlab > Troubleshooting"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://chanhi2000.github.io/images/gitlab/troubleshooting/job-failing-w-the-rorror-npm-command-not-found.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"gitlab"}],["meta",{"property":"article:tag","content":"yml"}],["meta",{"property":"article:tag","content":"sh"}],["meta",{"property":"article:tag","content":"gitlab-cli"}],["meta",{"property":"article:tag","content":"gitlab-ci"}],["meta",{"property":"article:tag","content":"gitlab"}],["meta",{"property":"article:tag","content":"git"}],["meta",{"property":"article:tag","content":"troubleshooting"}]]},"git":{},"readingTime":{"minutes":3.62,"words":1087},"filePathRelative":"devops/gitlab/troubleshooting.md"}');export{j as comp,T as data};
